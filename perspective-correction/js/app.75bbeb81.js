(function(e){function t(t){for(var n,r,s=t[0],c=t[1],u=t[2],l=0,d=[];l<s.length;l++)r=s[l],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&d.push(o[r][0]),o[r]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);h&&h(t);while(d.length)d.shift()();return a.push.apply(a,u||[]),i()}function i(){for(var e,t=0;t<a.length;t++){for(var i=a[t],n=!0,r=1;r<i.length;r++){var c=i[r];0!==o[c]&&(n=!1)}n&&(a.splice(t--,1),e=s(s.s=i[0]))}return e}var n={},o={app:0},a=[];function r(e){return s.p+"js/"+({about:"about"}[e]||e)+"."+{about:"f48ec7ad"}[e]+".js"}function s(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.e=function(e){var t=[],i=o[e];if(0!==i)if(i)t.push(i[2]);else{var n=new Promise((function(t,n){i=o[e]=[t,n]}));t.push(i[2]=n);var a,c=document.createElement("script");c.charset="utf-8",c.timeout=120,s.nc&&c.setAttribute("nonce",s.nc),c.src=r(e);var u=new Error;a=function(t){c.onerror=c.onload=null,clearTimeout(l);var i=o[e];if(0!==i){if(i){var n=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+n+": "+a+")",u.name="ChunkLoadError",u.type=n,u.request=a,i[1](u)}o[e]=void 0}};var l=setTimeout((function(){a({type:"timeout",target:c})}),12e4);c.onerror=c.onload=a,document.head.appendChild(c)}return Promise.all(t)},s.m=e,s.c=n,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(i,n,function(t){return e[t]}.bind(null,n));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/perspective-correction/",s.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var h=u;a.push([0,"chunk-vendors"]),i()})({0:function(e,t,i){e.exports=i("cd49")},"0e77":function(e,t,i){"use strict";var n=i("6edb"),o=i.n(n);o.a},"5c0b":function(e,t,i){"use strict";var n=i("9c0c"),o=i.n(n);o.a},"6edb":function(e,t,i){},"9c0c":function(e,t,i){},cd49:function(e,t,i){"use strict";i.r(t);i("e260"),i("e6cf"),i("cca6"),i("a79d");var n=i("2b0e"),o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-app",{attrs:{id:"inspire"}},[i("v-app-bar",{attrs:{app:"","clipped-left":"",dark:"",color:"blue darken-1"}},[i("v-toolbar-title",[e._v("Perspective Correction")])],1),i("v-main",[i("router-view")],1),i("v-footer",{attrs:{app:""}},[i("span",[e._v("Â© "+e._s((new Date).getFullYear()))])])],1)},a=[],r=(i("5c0b"),i("2877")),s=i("6544"),c=i.n(s),u=i("7496"),l=i("40dc"),h=i("553a"),d=i("f6c4"),p=i("2a7f"),f={},v=Object(r["a"])(f,o,a,!1,null,null,null),m=v.exports;c()(v,{VApp:u["a"],VAppBar:l["a"],VFooter:h["a"],VMain:d["a"],VToolbarTitle:p["a"]});var b=i("f309");n["a"].use(b["a"]);var w=new b["a"]({}),y=(i("d3b7"),i("8c4f")),g=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-container",{staticClass:"home fill-height"},[i("v-row",{staticClass:"text-center"},[i("ImageFile",{on:{select:e.onSelected}})],1),i("v-row",{staticClass:"text-center"},[i("ImageEditor",{attrs:{currentFile:e.currentFile}})],1)],1)},x=[],j=i("d4ec"),O=i("bee2"),k=i("262e"),z=i("2caf"),C=i("9ab4"),P=i("60a3"),E=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-container",[i("v-row",{staticClass:"text-center"},[i("v-col",[i("v-file-input",{attrs:{label:"File input",type:"file",accept:"image/*",name:"img"},on:{change:e.onChange},model:{value:e.item,callback:function(t){e.item=t},expression:"item"}})],1)],1)],1)},F=[],_=function(e){Object(k["a"])(i,e);var t=Object(z["a"])(i);function i(){var e;return Object(j["a"])(this,i),e=t.apply(this,arguments),e.item=new File([],""),e}return Object(O["a"])(i,[{key:"select",value:function(e){}},{key:"onChange",value:function(e){this.item=e,this.select(this.item)}}]),i}(P["d"]);Object(C["a"])([Object(P["b"])()],_.prototype,"select",null),_=Object(C["a"])([P["a"]],_);var M=_,D=M,I=(i("0e77"),i("62ad")),L=i("a523"),V=i("23a7"),R=i("0fd9"),S=Object(r["a"])(D,E,F,!1,null,null,null),T=S.exports;c()(S,{VCol:I["a"],VContainer:L["a"],VFileInput:V["a"],VRow:R["a"]});var H=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-container",[i("v-row",[i("v-col",{staticClass:"col-8"},[i("h3",[e._v("Image")]),i("canvas",{staticClass:"preview",staticStyle:{width:"100%"},attrs:{id:"preview",width:e.size,height:e.size}}),i("div",[i("code",[e._v(e._s(e.points))])])]),i("v-col",{staticClass:"col-4"},[i("h3",[e._v("Cropped")]),i("canvas",{staticClass:"preview",staticStyle:{width:"100%"},attrs:{id:"cropped",width:e.outputWidth,height:e.outputHeight}}),i("v-container",[i("v-row",[i("v-text-field",{attrs:{label:"Width",value:"1024",suffix:"px"},model:{value:e.outputWidth,callback:function(t){e.outputWidth=t},expression:"outputWidth"}})],1),i("v-row",[i("v-text-field",{attrs:{label:"Height",value:"646",suffix:"px"},model:{value:e.outputHeight,callback:function(t){e.outputHeight=t},expression:"outputHeight"}})],1),i("v-row",[i("v-btn",{attrs:{block:"",color:"blue darken-1",dark:""},on:{click:e.downloadFile}},[e._v("Download")])],1)],1)],1)],1)],1)},U=[],W=(i("99af"),i("cb29"),i("4160"),i("d81d"),i("13d5"),i("a434"),i("b0c0"),i("8a59"),i("9a8c"),i("a975"),i("735e"),i("c1ac"),i("d139"),i("3a7b"),i("d5d6"),i("82f8"),i("e91f"),i("60bd"),i("5f96"),i("3280"),i("3fcc"),i("ca91"),i("25a1"),i("cd26"),i("3c5d"),i("2954"),i("649e"),i("219c"),i("170b"),i("b39a"),i("72f7"),i("159b"),i("c8bb")),A=function(e){Object(k["a"])(i,e);var t=Object(z["a"])(i);function i(){var e;return Object(j["a"])(this,i),e=t.apply(this,arguments),e.width=0,e.height=0,e.outputWidth=1024,e.outputHeight=Math.round(5529.6/8.56),e.isMouseDown=!1,e.focused={key:0,state:!1},e.mousePosition={x:0,y:0},e.canvas=W["canvas"](),e.offset={x:0,y:0},e.imageSize={w:0,h:0},e.size=2048,e.points=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],e}return Object(O["a"])(i,[{key:"fileChanged",value:function(){var e=this;if(void 0!==this.currentFile&&""!=this.currentFile.name){var t=new FileReader;t.readAsDataURL(this.currentFile),t.onload=function(t){var i=new Image;i.onload=function(t){var n=[i.height,i.width],o=n[0],a=n[1],r=Math.max(o/e.size,a/e.size);e.imageSize={w:a,h:o},e.offset.x=(e.size-a/r)/2,e.offset.y=(e.size-o/r)/2,e.context.drawImage(i,e.offset.x,e.offset.y,a/r,o/r),e.imageData=e.context.getImageData(0,0,e.size,e.size);var s=new Image;s.onload=function(t){e.texture=e.canvas.texture(s)},s.src=e.preview.toDataURL(),e.resetPoints(),e.draw()};var n=t.target;i.src=n.result}}}},{key:"downloadFile",value:function(){if(null!=this.croppedURL){var e=this.croppedURL,t=document.createElement("a");t.href=e,t.setAttribute("download","file.jpg"),document.body.appendChild(t),t.click()}}},{key:"resetPoints",value:function(){this.points[0]={x:this.size/4,y:this.size/4},this.points[1]={x:this.size/4*3,y:this.size/4},this.points[2]={x:this.size/4*3,y:this.size/4*3},this.points[3]={x:this.size/4,y:this.size/4*3}}},{key:"mounted",value:function(){document.getElementById("view");var e=document.getElementById("preview");this.context=e.getContext("2d"),this.preview=e,this.width=window.innerWidth,this.height=window.innerHeight,window.addEventListener("resize",this.windowResize),document.addEventListener("mousemove",this.mouseMove,!1),document.addEventListener("mousedown",this.mouseDown,!1),document.addEventListener("mouseup",this.mouseUp,!1)}},{key:"beforeDestroy",value:function(){window.removeEventListener("resize",this.windowResize),document.removeEventListener("mousemove",this.mouseMove),document.removeEventListener("mousedown",this.mouseDown),document.removeEventListener("mouseup",this.mouseUp)}},{key:"windowResize",value:function(e){this.width=window.innerWidth,this.height=window.innerHeight,console.log(this.width,this.height)}},{key:"drawCropped",value:function(){if(null!=this.texture){var e=this.points.map((function(e){return[e.x,e.y]})).reduce((function(e,t){return e.concat(t,[])})),t=this.outputWidth,i=this.outputHeight,n=[0,0,t,0,t,i,0,i],o=(this.imageSize,this.canvas.draw(this.texture,this.size,this.size).perspective(e,n).update()),a=document.getElementById("cropped"),r=a.getContext("2d"),s=this.canvas.getPixelArray(),c=new ImageData(new Uint8ClampedArray(s),o.width,o.height);r.putImageData(c,0,0),this.croppedURL=a.toDataURL("image/jpg")}}},{key:"draw",value:function(){var e=this.context;e.putImageData(this.imageData,0,0),e.lineWidth=4,e.strokeStyle="#F865B0",e.beginPath(),e.moveTo(this.points[3].x,this.points[3].y),this.points.forEach((function(t){e.lineTo(t.x,t.y)})),e.stroke(),e.closePath(),e.fillStyle="rgba(255, 255, 255, 0.1)",this.points.forEach((function(t){e.lineTo(t.x,t.y),e.beginPath(),e.arc(t.x,t.y,20,0,2*Math.PI),e.fill(),e.stroke(),e.closePath()})),this.drawCropped()}},{key:"mouseMove",value:function(e){var t=this;if(this.isMouseDown){var i=this.preview.getBoundingClientRect();if(this.mousePosition={x:Math.round((e.x-i.left)*this.size/(i.right-i.left)),y:Math.round((e.y-i.top)*this.size/(i.bottom-i.top))},this.mousePosition={x:Math.min(Math.max(this.mousePosition.x,0),this.size),y:Math.min(Math.max(this.mousePosition.y,0),this.size)},this.focused.state)return this.points.splice(this.focused.key,1,this.mousePosition),void this.draw();this.points.forEach((function(e,i){t.intersects(e)&&(t.focused.key=i,t.focused.state=!0)})),this.draw()}}},{key:"mouseUp",value:function(e){this.isMouseDown=!1,this.focused.state=!1}},{key:"mouseDown",value:function(e){this.isMouseDown=!0}},{key:"intersects",value:function(e){var t=20,i=this.mousePosition.x-e.x,n=this.mousePosition.y-e.y;return i*i+n*n<=t*t}}]),i}(P["d"]);Object(C["a"])([Object(P["c"])()],A.prototype,"currentFile",void 0),Object(C["a"])([Object(P["e"])("currentFile")],A.prototype,"fileChanged",null),A=Object(C["a"])([Object(P["a"])({directives:{}})],A);var B=A,$=B,J=(i("fb31"),i("8336")),q=i("8654"),Y=Object(r["a"])($,H,U,!1,null,null,null),G=Y.exports;c()(Y,{VBtn:J["a"],VCol:I["a"],VContainer:L["a"],VRow:R["a"],VTextField:q["a"]});var K=function(e){Object(k["a"])(i,e);var t=Object(z["a"])(i);function i(){var e;return Object(j["a"])(this,i),e=t.apply(this,arguments),e.selectedIndex=0,e.currentFile=new File([],""),e}return Object(O["a"])(i,[{key:"onSelected",value:function(e){this.currentFile=e}}]),i}(P["d"]);K=Object(C["a"])([Object(P["a"])({components:{ImageFile:T,ImageEditor:G}})],K);var N=K,Q=N,X=Object(r["a"])(Q,g,x,!1,null,null,null),Z=X.exports;c()(X,{VContainer:L["a"],VRow:R["a"]}),n["a"].use(y["a"]);var ee=[{path:"/",name:"Home",component:Z},{path:"/about",name:"About",component:function(){return i.e("about").then(i.bind(null,"f820"))}}],te=new y["a"]({mode:"history",base:"/perspective-correction/",routes:ee}),ie=te;n["a"].config.productionTip=!1,new n["a"]({vuetify:w,router:ie,render:function(e){return e(m)}}).$mount("#app")},f024:function(e,t,i){},fb31:function(e,t,i){"use strict";var n=i("f024"),o=i.n(n);o.a}});
//# sourceMappingURL=app.75bbeb81.js.map