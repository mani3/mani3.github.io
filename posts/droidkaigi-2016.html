<!DOCTYPE html>
<html lang="ja">

<head>
  <!-- Required meta tags always come first -->
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>DroidKaigi メモ | Lavieleaf
</title>
  <link rel="canonical" href="../posts/droidkaigi-2016.html">

  <link rel="alternate" type="application/rss+xml" href="https://mani3.github.io/feeds/all.rss.xml" title="Full RSS Feed">
  <link rel="alternate" type="application/rss+xml" href="https://mani3.github.io/feeds/category.slug.rss.xml" title="Categories RSS Feed">


  <link rel="stylesheet" href="../theme/css/bootstrap.min.css">
  <link rel="stylesheet" href="../theme/css/font-awesome.min.css">
  <link rel="stylesheet" href="../theme/css/pygments/paraiso-dark.min.css">
  <link rel="stylesheet" href="../theme/css/style.css">
  <link href="https://fonts.googleapis.com/earlyaccess/roundedmplus1c.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/earlyaccess/nicomoji.css" rel="stylesheet" />

  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-9947041075020516",
      enable_page_level_ads: true
    });
  </script>


<meta name="description" content="DoroidKaigi 2016 メモ">
<script>
  (function(i, s, o, g, r, a, m) {
    i['GoogleAnalyticsObject'] = r;
    i[r] = i[r] || function() {
      (i[r].q = i[r].q || []).push(arguments)
    }, i[r].l = 1 * new Date();
    a = s.createElement(o);
    a.async = 1;
    a.src = g;
    m = s.getElementsByTagName(o)[0];
    m.parentNode.insertBefore(a, m)
  })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
  ga('create', 'UA-26392156-5', 'auto');
  ga('send', 'pageview');
</script>
</head>

<body>
  <header class="header">
    <div class="container">
      <div class="row">
        <div class="col-sm-12">
          <h1 class="title"><a href="..">Lavieleaf</a></h1>
          <p class="text-muted">おもったことをなんでも書くことろ</p>
          <ul class="list-inline">
            <li class="list-inline-item"><a class="fa fa-github" href="https://github.com/mani3" target="_blank"></a></li>
          </ul>
        </div>
      </div>
    </div>
  </header>

  <div class="main">
    <div class="container">
      <h1>DroidKaigi メモ
</h1>
      <hr>
<article class="article">
  <header>
    <ul class="list-inline">
      <li class="list-inline-item text-muted" title="2016-02-20T01:16:53+09:00">
        <i class="fa fa-clock-o"></i>
        Sat 20 February 2016
      </li>
      <li class="list-inline-item">
        <i class="fa fa-folder-open-o"></i>
        <a href="../category/development.html">development</a>
      </li>
      <li class="list-inline-item">
        <i class="fa fa-user-o"></i>
        <a href="../author/mani3.html">mani3</a>      </li>
      <li class="list-inline-item">
        <i class="fa fa-files-o"></i>
        <a href="../tag/android.html">#android</a>      </li>
    </ul>
  </header>
  <div class="content">
    <h1>DroidKaigi</h1>
<h2>1日目</h2>
<h3>OSSの動向をとらえた実装方針</h3>
<p><code>10:00 ~ Keynote</code></p>
<p>すごい勢いでライブラリを紹介してた</p>
<h4>Rearch</h4>
<ul>
<li><a href="https://github.com/trending/java?since=daily">Github/Trending java</a></li>
<li><a href="http://androidweekly.net/#latest-issue">Android Weekly</a></li>
<li><a href="https://android-arsenal.com/">Android Arsenal</a></li>
<li><a href="http://www.android-gems.com/">Android Gems</a></li>
</ul>
<h4>Memo</h4>
<h5>Java8</h5>
<ul>
<li><a href="https://github.com/orfjackal/retrolambda">Retrolambda</a></li>
<li><a href="https://github.com/aNNiMON/Lightweight-Stream-API">Lightweight-Stream-API</a></li>
<li><a href="https://github.com/JakeWharton/ThreeTenABP">ThreeTenABP</a><ul>
<li>JSR-310</li>
</ul>
</li>
</ul>
<h5>Views</h5>
<ul>
<li><a href="http://android-developers.blogspot.jp/2015/05/android-design-support-library.html">Support Library Design</a></li>
<li><a href="https://github.com/chrisjenx/Calligraphy">Calligraphy</a><ul>
<li>Fontを適用できる</li>
</ul>
</li>
<li><a href="https://github.com/florent37/ViewAnimator">ViewAnimator</a></li>
</ul>
<h5>Data Binding</h5>
<ul>
<li><a href="http://developer.android.com/intl/ja/tools/data-binding/guide.html">Android Data Binding</a></li>
</ul>
<h5>Networking</h5>
<ul>
<li><a href="http://square.github.io/retrofit/">Retrofit</a> + <a href="http://square.github.io/okhttp/">OkHttp</a></li>
</ul>
<h5>Parcelables</h5>
<ul>
<li><a href="https://github.com/johncarl81/parceler">Paceler</a></li>
<li><a href="https://github.com/frankiesardo/icepick">Icepick</a></li>
</ul>
<h5>Image Loader</h5>
<ul>
<li><a href="https://github.com/bumptech/glide">Glide</a></li>
</ul>
<h4>Effect</h4>
<ul>
<li><a href="https://github.com/wasabeef/Blurry">Blurry</a></li>
</ul>
<h5>DB/ORM</h5>
<ul>
<li><a href="https://github.com/gfx/Android-Orma">Android Orma</a></li>
</ul>
<h5>Debugger</h5>
<ul>
<li><a href="https://github.com/facebook/stetho">Stetho</a></li>
</ul>
<p>とりあえず使ってみたいやつだけ</p>
<h3>TV向けAndroid開発Tipsと最新事情</h3>
<p><code>11:30 ~ #DroidKaigiB</code></p>
<h5>TV向けデバイス</h5>
<ul>
<li>試すなら <a href="http://www.amazon.co.jp/Amazon-W87CUN-Fire-TV-Stick/dp/B00ZVNYLS8">Android Fire TV Stick</a>が一番安くていいかも</li>
</ul>
<h5>TIPS</h5>
<ul>
<li>Leanbackライブラリ(TV用UIパターン)</li>
<li>オーバスキャン&amp;セーフティエリア考慮(上下27dp，左右48dp)</li>
<li>画面サイズはフルHDを想定</li>
<li>10ft(3mくらい) 離れてTVを見てることを想定したUI/UXが必要</li>
</ul>
<p>ゲームアプリとかTV向けにビルドするだけでそのまま動くけど，Android TV自体スペックがそんなに高くないので注意が必要</p>
<h3>Go MobileでAndroidアプリ開発</h3>
<p><code>13:00 ~ #DroidKaigiC</code></p>
<h5>Androidで動くツール</h5>
<ul>
<li><code>GOOS=linux GOARCH=arm go build</code> でとりあえず動く</li>
<li>ただピュアGoのみ</li>
<li>端末内にサーバ立てるのが容易</li>
</ul>
<h5>Go Moblie</h5>
<ul>
<li>SDKアプリ (<code>gomobile bind</code>)<ul>
<li>goをライブラリ(aar)として利用できる</li>
</ul>
</li>
<li>Nativeアプリ (<code>gomobile build</code>)<ul>
<li>goのみでapkファイルが生成される</li>
<li>Google Playに申請できない(resが含められない)</li>
<li><a href="https://github.com/golang/mobile/tree/master/example/flappy">Flappy Gopher</a></li>
</ul>
</li>
</ul>
<h3>Advanced Android Espresso</h3>
<p><code>14:00 ~ #DroidKaigiD</code></p>
<ul>
<li>https://github.com/chiuki/espresso-samples</li>
<li>RecyclerViewではonDataが使えない<ul>
<li>onDataはAdapterViewで使える，RecyclerViewはViewGroupを継承してるので使えない</li>
</ul>
</li>
</ul>
<h3>How Instant Run Works</h3>
<p><code>15:10 ~ #DroidKaigiD</code></p>
<ul>
<li>Dex Sharding(default: 10)というのでdexを分割してる</li>
<li>Data BindingやKotlinを使っている場合は注意が必要</li>
</ul>
<h3>Androidの省電力について考える</h3>
<p><code>15:50 ~ #DroidKaigiB</code></p>
<h5>歴史</h5>
<ul>
<li>メーカー，キャリアが努力(省エネアプリとか)</li>
<li>キャリアとかがガイドラインを出す(知らない。。)</li>
<li>Android 6.0からOSレベルで対策が入る(Dozeとか)</li>
</ul>
<h5>Google</h5>
<ul>
<li>Fused Location Provider</li>
<li>Sensor Batching (Android 4.4~)</li>
<li>Job Scheduler (Android 5.0~)</li>
<li>Battery Saver (Android 5.0~)</li>
</ul>
<h5>Android 6.0 ~</h5>
<ul>
<li>Doze<ul>
<li>対象のアプリのみGCMのHigh priorityにするとDozeを抜ける</li>
<li>テストするときは <code>adb shell dumpsys battery unplug</code> とか</li>
</ul>
</li>
<li>App standby<ul>
<li>ホワイトリスト登録用のダイアログ表示するとか</li>
<li><a href="http://developer.android.com/training/monitoring-device-state/doze-standby.html">http://developer.android.com/training/monitoring-device-state/doze-standby.html</a></li>
</ul>
</li>
</ul>
<h3>実践Android Studioプラグイン開発</h3>
<p><code>16:30 ~ #DroidKaigiB</code></p>
<h5>Java6，IntelliJが必要</h5>
<h5>参考になるリポジトリ</h5>
<ul>
<li><a href="https://github.com/JetBrains/intellij-sdk-docs">intellij-sdk-docs</a></li>
<li><a href="https://github.com/mcharmas/android-parcelable-intellij-plugin">android-parcelable-intellij-plugin</a></li>
<li><a href="https://github.com/winterDroid/android-drawable-importer-intellij-plugin">android-drawable-importer-intellij-plugin</a></li>
<li><a href="https://github.com/pbreault/adb-idea">adb-idea</a></li>
<li><a href="http://tools.android.com/build">Android Studio code</a></li>
</ul>
<h2>2日目</h2>
<h3>Support Libraryのススメ</h3>
<p><code>10:00 ~ keynote</code></p>
<ul>
<li>バグがあったら <a href="http://b.android.com">b.android.com</a>まで(スクリーンショット付で)</li>
<li>Fragmentはv4の方を使ったほうがいい，designとかのライブラリがv4のFragmentを元にしてる</li>
<li>CoordinatorLayout.Behaviorを使ってみようっと</li>
</ul>
<h3>生まれ変わったUI Automatorを使いこなす</h3>
<p><code>11:30 ~ #DroidKaigiB</code></p>
<h5>自動テストツール: Ui Automator2</h5>
<ul>
<li>ブラックボックステスト向け</li>
<li>Android Studio対応になった</li>
<li>Lolipop以上のUI Automatorを使ったほうがいい</li>
</ul>
<h5>使い方</h5>
<ul>
<li>UiDeviceを初期化する</li>
<li>findObjectに注意する</li>
<li>UiSelector/UIObject, BySelector/UIObject2の違いに注意する</li>
<li>スクロールはfindObjectは使わない、UiScrollableを使う</li>
</ul>
<h5>待ち合わせ</h5>
<ul>
<li>UiSelector/UiObjectの操作 + 同期メソッドを使う</li>
<li>BySelector/UiObject2 Until~を一緒に使う</li>
</ul>
<h5>Tips</h5>
<ul>
<li>バックキー: UiDevice#waitを使う</li>
<li>UI監視 UiWatcher UIが見つからない時にコールされる</li>
<li>
<p>タイムアウト値
|  | UiDevice | UiObject | UiObject2 |
|:--|:--:|:--:|:--:|
| Idle Timeout| o | x | o |
| Selector Timeout | x | o | x |
| Action Acknowledgment Timeout | x | o | x |</p>
</li>
<li>
<p>WebView操作できるメソッドはない</p>
<ul>
<li>Appiumがおすすめ</li>
</ul>
</li>
</ul>
<h5>使いどころ</h5>
<ul>
<li>Espressoと併用がおすすめ</li>
<li>基本Espressoで書いて、EspressoできないとこをUiAutomator2を使う<ul>
<li>システムダイアログを押すとか(Espressoではできない)</li>
</ul>
</li>
</ul>
<h3>パフォーマンスを追求したアプリを作るには</h3>
<p><code>13:00 ~ #DroidKaigiB</code></p>
<h4>パフォーマンスの指標になるもの</h4>
<ul>
<li>電力消費</li>
<li>UI</li>
<li>その他(通信、メモリ、プロセッサ)</li>
</ul>
<h4>電力消費</h4>
<ul>
<li>計測は未給電で行う <code>dumpsys battery unplug</code> or <code>set usb 0</code></li>
<li>wifiでADB接続 -&gt; 更新停止 -&gt; USBでADB接続 が良さそう</li>
</ul>
<h5>電流消費量を知るには..</h5>
<ul>
<li>framework-res.apk</li>
<li>res/xml/power_profile.xml</li>
<li>デバイスベンダーの電力消費の申告値が記載されてる(目安)</li>
<li>0.1はデフォルト</li>
</ul>
<h5>バッテリー消費の可視化ツール</h5>
<ul>
<li><code>dumpsys batterystats</code>とかで見ることができるけど以下が便利</li>
<li><a href="https://github.com/google/battery-historian">Battery Historian</a></li>
</ul>
<h4>UI</h4>
<h5>利用者の反応指標</h5>
<ul>
<li>ユーザがアクションしてから250ms以下で応答すればとりあえずストレスにならない</li>
</ul>
<h5>レンダリングの歴史</h5>
<ul>
<li>GB: CPU使用</li>
<li>Honeycomb : ハードディスクアクセラレータ</li>
<li>ICS: ハードディスクアクセラレータ</li>
<li>JetBean: VSyncによるフレーム最適化</li>
</ul>
<p>ほぼ60fpsで描画される</p>
<h5>Jank</h5>
<p>間に合わない場合Jankが発生する-&gt; Jankを減らすことが大事</p>
<h5>Viewレンダリング</h5>
<ul>
<li>onMeasure，onLayout，onDrawの各段階ごとにHierarcy Viewerで描画時間が閲覧できる</li>
<li>Drawに最も時間がかかるのが一般的</li>
<li>Measureが遅い場合大抵レイアウトのネストが原因</li>
<li>Overdrawを確認する -&gt; Hierarchy ViewerでPSDファイルに出力して確認できる</li>
<li>dumpsys gfxinfo (GPU プロファイル)</li>
</ul>
<h4>その他(通信、メモリ、プロセッサ)</h4>
<h5>通信の最適化</h5>
<ul>
<li>AT&amp;T ARO 通信最適化ツール</li>
</ul>
<h5>メモリの最適化</h5>
<ul>
<li>dumpsys meminfo プロセスID指定で見れる</li>
<li>Heap dump</li>
<li>Leak Canary</li>
</ul>
<h5>CPUの最適化</h5>
<ul>
<li>dumpsys cpuinfo</li>
<li>Systrace</li>
<li>Trepn Powor Profiler (Qualcommプロセッサデバイスのみ．Bluetoothもみれる)</li>
</ul>
<h3>Advanced Kotlin for Android</h3>
<p><code>14:00 ~ #DroidKaigiB</code></p>
<ul>
<li>Swiftぽい，簡単そう</li>
</ul>
<h1>資料</h1>
<ul>
<li><a href="http://unsolublesugar.com/20160218/134940/">http://unsolublesugar.com/20160218/134940/</a></li>
</ul><script src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
  </div>
</article>
    </div>
  </div>

  <footer class="footer">
    <div class="container">
      <div class="row">
       <ul class="col-sm-6 list-inline">
          <li class="list-inline-item"><a href="../authors.html">Authors</a></li>
          <li class="list-inline-item"><a href="../archives.html">Archives</a></li>
          <li class="list-inline-item"><a href="../categories.html">Categories</a></li>
          <li class="list-inline-item"><a href="../tags.html">Tags</a></li>
        </ul>
        <p class="col-sm-6 text-sm-right text-muted">
          Generated by <a href="https://github.com/getpelican/pelican" target="_blank">Pelican</a> / <a href="https://github.com/nairobilug/pelican-alchemy" target="_blank">&#x2728;</a>
        </p>
      </div>
    </div>
  </footer>
</body>

</html>